%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Programming/Coding Assignment
% LaTeX Template
%
% This template has been downloaded from:
% http://www.latextemplates.com
%
% Original author:
% Ted Pavlic (http://www.tedpavlic.com)
%
% Note:
% The \lipsum[#] commands throughout this template generate dummy text
% to fill the template out. These commands should all be removed when
% writing assignment content.
%
% This template uses a Perl script as an example snippet of code, most other
% languages are also usable. Configure them in the "CODE INCLUSION
% CONFIGURATION" section.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass{article}

\usepackage{fancyhdr} % Required for custom headers
\usepackage{lastpage} % Required to determine the last page for the footer
\usepackage{extramarks} % Required for headers and footers
\usepackage[usenames,dvipsnames]{color} % Required for custom colors
\usepackage{graphicx} % Required to insert images
\usepackage{listings} % Required for insertion of code
\usepackage{courier} % Required for the courier font
\usepackage[utf8]{inputenc}

% Margins
\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

\linespread{1.1} % Line spacing

% Set up the header and footer
\pagestyle{fancy}
\lhead{\hmwkAuthorName} % Top left header
\chead{\hmwkClass\ : \hmwkTitle} % Top center head
\rhead{\firstxmark} % Top right header
\lfoot{\lastxmark} % Bottom left footer
\cfoot{} % Bottom center footer
\rfoot{Page\ \thepage\ of\ \protect\pageref{LastPage}} % Bottom right footer
\renewcommand\headrulewidth{0.4pt} % Size of the header rule
\renewcommand\footrulewidth{0.4pt} % Size of the footer rule

\setlength\parindent{0pt} % Removes all indentation from paragraphs

%----------------------------------------------------------------------------------------
%	CODE INCLUSION CONFIGURATION
%----------------------------------------------------------------------------------------

\definecolor{MyDarkGreen}{rgb}{0.0,0.4,0.0} % This is the color used for comments
\lstloadlanguages{Perl} % Load Perl syntax for listings, for a list of other languages supported see: ftp://ftp.tex.ac.uk/tex-archive/macros/latex/contrib/listings/listings.pdf
\lstset{language=Perl, % Use Perl in this example
        frame=single, % Single frame around code
        basicstyle=\small\ttfamily, % Use small true type font
        keywordstyle=[1]\color{Blue}\bf, % Perl functions bold and blue
        keywordstyle=[2]\color{Purple}, % Perl function arguments purple
        keywordstyle=[3]\color{Blue}\underbar, % Custom functions underlined and blue
        identifierstyle=, % Nothing special about identifiers
        commentstyle=\usefont{T1}{pcr}{m}{sl}\color{MyDarkGreen}\small, % Comments small dark green courier font
        stringstyle=\color{Purple}, % Strings are purple
        showstringspaces=false, % Don't put marks in string spaces
        tabsize=5, % 5 spaces per tab
        %
        % Put standard Perl functions not included in the default language here
        morekeywords={rand},
        %
        % Put Perl function parameters here
        morekeywords=[2]{on, off, interp},
        %
        % Put user defined functions here
        morekeywords=[3]{test},
       	%
        morecomment=[l][\color{Blue}]{...}, % Line continuation (...) like blue comment
        numbers=left, % Line numbers on left
        firstnumber=1, % Line numbers start with line 1
        numberstyle=\tiny\color{Blue}, % Line numbers are blue and small
        stepnumber=5 % Line numbers go in steps of 5
}

% Creates a new command to include a perl script, the first parameter is the filename of the script (without .pl), the second parameter is the caption
\newcommand{\perlscript}[2]{
\begin{itemize}
\item[]\lstinputlisting[caption=#2,label=#1]{#1.pl}
\end{itemize}
}

%----------------------------------------------------------------------------------------
%	DOCUMENT STRUCTURE COMMANDS
%	Skip this unless you know what you're doing
%----------------------------------------------------------------------------------------

% Header and footer for when a page split occurs within a problem environment
\newcommand{\enterProblemHeader}[1]{
\nobreak\extramarks{#1}{#1 continued on next page\ldots}\nobreak
\nobreak\extramarks{#1 (continued)}{#1 continued on next page\ldots}\nobreak
}

% Header and footer for when a page split occurs between problem environments
\newcommand{\exitProblemHeader}[1]{
\nobreak\extramarks{#1 (continued)}{#1 continued on next page\ldots}\nobreak
\nobreak\extramarks{#1}{}\nobreak
}

\setcounter{secnumdepth}{0} % Removes default section numbers
\newcounter{homeworkProblemCounter} % Creates a counter to keep track of the number of problems

\newcommand{\homeworkProblemName}{}
\newenvironment{homeworkProblem}[1][Problem \arabic{homeworkProblemCounter}]{ % Makes a new environment called homeworkProblem which takes 1 argument (custom name) but the default is "Problem #"
\stepcounter{homeworkProblemCounter} % Increase counter for number of problems
\renewcommand{\homeworkProblemName}{#1} % Assign \homeworkProblemName the name of the problem
\section{\homeworkProblemName} % Make a section in the document with the custom problem count
\enterProblemHeader{\homeworkProblemName} % Header and footer within the environment
}{
\exitProblemHeader{\homeworkProblemName} % Header and footer after the environment
}

\newcommand{\problemAnswer}[1]{ % Defines the problem answer command with the content as the only argument
\noindent\framebox[\columnwidth][c]{\begin{minipage}{0.98\columnwidth}#1\end{minipage}} % Makes the box around the problem answer and puts the content inside
}

\newcommand{\homeworkSectionName}{}
\newenvironment{homeworkSection}[1]{ % New environment for sections within homework problems, takes 1 argument - the name of the section
\renewcommand{\homeworkSectionName}{#1} % Assign \homeworkSectionName to the name of the section from the environment argument
\subsection{\homeworkSectionName} % Make a subsection with the custom name of the subsection
\enterProblemHeader{\homeworkProblemName\ [\homeworkSectionName]} % Header and footer within the environment
}{
\enterProblemHeader{\homeworkProblemName} % Header and footer after the environment
}

%----------------------------------------------------------------------------------------
%	NAME AND CLASS SECTION
%----------------------------------------------------------------------------------------

\newcommand{\hmwkTitle}{TP1 : éléments de géométrie projective et calibration de caméra} % Assignment title
\newcommand{\hmwkDueDate}{mardi 27 septembre 2016} % Due date
\newcommand{\hmwkClass}{VisA} % Course/class
\newcommand{\hmwkClassTime}{} % Class/lecture time
\newcommand{\hmwkClassInstructor}{} % Teacher/lecturer
\newcommand{\hmwkAuthorName}{Arnaud Cojez} % Your name

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\title{
\vspace{2in}
\textmd{\textbf{\hmwkClass:\ \hmwkTitle}}\\
\normalsize\vspace{0.1in}\small{\hmwkDueDate}\\
\vspace{3in}
}

\author{\textbf{\hmwkAuthorName}}
\date{} % Insert date here if you want it to appear below your name

%----------------------------------------------------------------------------------------

\begin{document}

\maketitle

%----------------------------------------------------------------------------------------
%	TABLE OF CONTENTS
%----------------------------------------------------------------------------------------

%\setcounter{tocdepth}{1} % Uncomment this line if you don't want subsections listed in the ToC

\newpage
\tableofcontents
\newpage

%----------------------------------------------------------------------------------------
%	INTRO
%----------------------------------------------------------------------------------------

\section{Introduction}

- expliquer pourquoi on s'intéresse à la méthode de Zhang

Flexible, calibrer aisément la caméra.
Adapté pour utilisation sans connaissances en géométrie 3D our en vision artificielle.
La technique nécessite uniquement la caméra et un motif planaire, représenté avec au moins 2 orientations différentes.
Ce motif peut être facilement imprimé puis attaché à une surface planaire.
La caméra ou le plan peuvent être bougés librement.
Cette technique est simple à mettre en oeuvre, flexible, mais aussi très peu couteuse, au contraire des méthodes classiques qui nécessitaient par exemple des mires en 3 dimensions.

- expliquer vite fait comment fonctionne la méthode de Zhang

  Lire les coordonnees des points de la mire dans la scene
  Initialiser la matrice des contraintes
  Matrices des homographies
  Coordonnees de tous les points image
  Boucler pour toutes les images
    Lire les points de l'image
    Estimer l'homographie entre la mire et l' image
    Ajouter deux lignes de contraintes dans V
  Calculer le vecteur b
  Estimation de la matrice intrinseque
  Estimations des matrices extrinseques

À partir de la
- présenter les données qu'on possède
   des fichiers texte listant les coordonnées des points de la mire dans l'espace 3D, et celles des points extraits de 4 images de cette mire. La mire est constituée d'un damier régulier permettant de localiser 77 points situés aux coins des cases du damier.
- résumer ce qu'on va faire
on va calculer ça
  \begin{itemize}
 \item Les coordonnées homogènes de l'objet dans la scène.
 \item La matrice extrinsèque, qui donne les rotations et translations de la caméra dans scène.
 \item La matrice intrinsèque, qui donne les paramètres internes de la caméra, pouvant changer
 selon les réglages de la caméra.
\end{itemize}

\clearpage

%----------------------------------------------------------------------------------------
%	DÉTERMINATION DE L'HOMOGRAPHIE ENTRE POINTS DE LA SCÈNE ET POINTS PROJETÉS
%----------------------------------------------------------------------------------------

\section{Homographie et contraintes}

- Expliquer ce qu'est une homographie
Une homographie est une transformation linéaire entre deux plans projectifs.
Dans notre cas, cela correspond à la transformation entre le motif imprimé et la projection captée par la caméra.
- Expliquer à quoi ça nous sert
Ça nous servira à définir les contraintes qui nous serviront à trouver la matrice intrinsèque

- Montrer l'implémentation de ce truc
These are the two basic constraints on the intrinsic parameters, given one homography.  Because a
homography has 8 degrees of freedom and there are 6 extrinsic parameters (3 for rotation and 3 for
translation), we can only obtain 2 constraints on the intrinsic parameters.



%----------------------------------------------------------------------------------------
%	DÉTERMINATION DE LA MATRICE INTRINSÈQUE
%----------------------------------------------------------------------------------------

\section{Matrice Intrinsèque}

Matrice intrinsèque
les paramètres intrinsèques qui sont internes à la caméra
\begin{itemize}
\item f : la distance focale ;
\item k u  et  k v %{\displaystyle k_{u}{\mbox{ et }}k_{v}} k_u \mbox{ et } k_v : les facteurs d'agrandissement de l'image ;
\item c u  et  c v %{\displaystyle c_{u}{\mbox{ et }}c_{v}} c_u \mbox{ et } c_v : les coordonnées de la projection du centre optique de la caméra sur le plan image ;
\item s u v %{\displaystyle s_{uv}} s_{uv} : qui traduit la non-orthogonalité potentielle des lignes et des colonnes de cellules électroniques photosensibles qui composent le capteur de la caméra. La plupart du temps, ce paramètre est négligé et prend donc une valeur nulle.
\end{itemize}

p19 récupere les paramètres puis on les bazarde dans une matrice
- Montrer l'implémentation


%----------------------------------------------------------------------------------------
%	DÉTERMINATION DE LA MATRICE EXTRINSÈQUE
%----------------------------------------------------------------------------------------

\section{Matrice Extrinsèque}
paramètres extrinsèques qui peuvent varier suivant la position de la caméra dans l'espace de travail.
\begin{itemize}
\item %R_{{3\times 3}} : qui est la matrice de rotation permettant de passer du repère lié à l'espace de travail au repère lié à la caméra ;
\item %t x , t y  et  t z {\displaystyle t_{x},t_{y}{\mbox{ et }}t_{z}} t_x, t_y \mbox{ et }t_z : qui sont les composantes du vecteur de translation permettant de passer du repère lié à l'espace de travail au repère lié à la caméra.
\end{itemize}
- Montrer l'implémentation

%----------------------------------------------------------------------------------------
%	RÉSULTATS OBTENUS
%----------------------------------------------------------------------------------------

\section{Résultats}

c'est très la ressemblance

%----------------------------------------------------------------------------------------
%	VERSION SIMPLIFIÉE
%----------------------------------------------------------------------------------------

\section{Zhang simplifié}

Si on suppose que ces paramètres sont connus par construction (taille du capteur, nombre de pixels, etc.), indiquer comment on peut modifier la méthode de Zhang afin de ne déterminer que la distance focale de la caméra (exprimée en unités pixel).

%tout doux

%----------------------------------------------------------------------------------------

%----------------------------------------------------------------------------------------
%	CONCLUSION
%----------------------------------------------------------------------------------------

\section{Conclusion}

- On a donc les 2 matrices qui vont bien
- Grâce à ça on connait les paramètres de la caméra, alors qu'ils n'étaient pas donnés par le constructeur
- Pratique car pas besoin de trop de matos

%----------------------------------------------------------------------------------------

\end{document}
